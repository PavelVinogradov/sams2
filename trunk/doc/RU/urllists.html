<HTML>
<HEAD>
<TITLE>Проект SAMS. Документация.</TITLE>
<META  content="text/html; charset=koi8-r" http-equiv="Content-Type">
</HEAD>
<BODY>
<H3> Списки перенаправления запросов</H3>
Списки перенаправления запросов предназначены для группировки URL,
запросы пользователей к которым необходимо перенаправить на другой адрес.
Наиболее часто используется подмена графических ресурсов. Например, подмена
запросов к баннерным системам или счетчикам посещения пользователей.
<BR>Правила составления URL
<BR>Можно вводить как URL целиком:
<BR>rotabanner.utro.ru/cgi-bin/banner/65
<BR>так и при помощи регулярных выражений PERL:
<BR>/(adv?|rb)(\d+)?\..+\.\w{2}\w?\w?


<H3>Списки запрета доступа</H3>
Списки запрета доступа предназначены для группировки URL, доступ к
которым пользователями нежелателен. С их помощью становится возможным 
формирование шаблонов доступа пользователей к ресурсам Интернет. 
<BR>Если в шаблоне пользователя указать только списки URL, доступ к которым
пользователю разрешен, то пользователь сможет посещать только ресурсы из этих списков,
доступ к другим ресурсам будет ему запрещен. Эта возможность полностью не протестирована,
и, возможно не работает с редиректором SquidGuard

<P>Запрет доступа пользователей к нежелательным URL может быть осуществлен одним из способов:
<BR>1. Встроенный SQUID (с помощью ACL SQUID). На основе списков запрета
доступа SAMS создает ACL для SQUID и SQUID сам проверяет права доступа пользователя к URL...
Скрипт редиректора создается согласно документации на SQUID (на языке Перл).
<BR> Говорят, что при нескольких десятках тысяч URL в списках SQUID начинает глючить...  
<BR>2. SAMS. Редиректор непосредственно общается с базой в MySQL, за счет этого при большом 
количестве одновременных запросов может быть некоторое торможение.
<BR>3. SquidGuard.Мощный редиректор с большой собственной базой URL. 
<P>Правила составления URL
<BR>Можно вводить как URL целиком:
<BR>anekdot.ru
<BR>так и при помощи регулярных выражений PERL:


<H2>Списки "Регулярные выражения"</H2>
Устаревшие списки. Оставлены для совместимости со старыми версиями. Выполняют туже функцию, что и 
Списки запрета доступа

<H3>Список "Локальные домены"</H3>
Список "Локальные домены" предназначен для группировки URL, доступ пользователей к
которым не будет учитываться при подсчете трафика.
<P><B>Правила внесения хостов в список "Локальные домены"</B>
<BR>В список локальные домены вносятся как ip адреса так и URL доменов.
<BR> Если в настройках выставлен соответствующий флаг, возможно при обработке логов производить 
преобразование URL в IP адреса.
<BR>Таким образом, можно задать диапазон ip адресов, неподлежащих учету, далее при обработке логов, 
парсер будет проверять, попадает данный URL в диапазон, или нет.
<BR>примеры занесения в список:
<BR>linux.perm.ru - весь трафик с хоста linux.perm.ru заноситься в базу и учитываться не будет
<BR>192.168.0.1 - весь трафик с хоста 192.168.0.1 заноситься в базу и учитываться не будет
<BR>192.168.0.0/16 - весь трафик из подсети 192.168.0.0/255.255.0.0 заноситься в базу и учитываться не будет
<BR>192.168.0.0/255.255.255.0 - весь трафик из подсети 192.168.0.0/255.255.255.0 заноситься в базу и учитываться не будет
<P>
<B>Внимание!!! </B>В SAMS может существовать только один список локальных доменов!



<H3> Работа со списками URL </H3>
<P><B>Создание нового списка</B>

<BR><IMG SRC="../img/2.jpg">
<BR>Рис.3. Диалог создания нового списка
<BR> Для создания нового списка перенаправления запросов необходимо в меню выбрать
пункт <Перенаправление>.
<BR>В появившемся в правой части окна диалоге создания
 нового списка (рис.3). необходимо ввести название нового списка
<BR><IMG SRC="../img/3.jpg">
<BR>Рис.4. Диалог изменеия списка URL
<P><B>Добавление URL в список перенаправления запросов</B>
<BR>Для добавления нового URL в список перенаправления запросов, необходимо установить
фокус на этом списке, и в появившемся в правой части окна диалоге (рис.4).
ввести URL.


<P><B>Удаление URL из списка перенаправления запросов</B>
<BR>Для удаления URL из списка запрета доступа , необходимо установить фокус
 на этом списке и, в появившемся в правой части окна диалоге (рис.4)., выбрать
в списке URL и нажать кнопку <Удалить URL>

<P><B>Удаление списка перенаправления запросов</B>

<TABLE WIDTH="90%"><TR>
<TD>Для удаления списка перенаправления запросов необходимо установить фокус на этом
списке и, в появившемся в правой части окна диалоге, нажать кнопку:
<TD><IMG SRC="../img/trash.jpg">
</TABLE>


<P><B>Импортирование списка перенаправления запросов в файл</B>
<TABLE WIDTH="90%"><TR>
<TD>Для импортирования списка перенаправления запросов необходимо установить фокус
 на этом списке и, в появившейся в правой части окна панели инструментов,
выбрать кнопку:
<BR><FONT COLOR="RED"><B>!</B></FONT> Импортируемый список должен представлять
из себя текстовый файл, содержащий в себе URL, разделенные символом перевода
 строки
<TD><IMG SRC="../img/import_48.jpg">
</TABLE>


<P><B>Экспортрование списка перенаправления запросов в файл</B>
<TABLE WIDTH="90%"><TR>
<TD>Для экспортирования списка запрета доступа необходимо установить фокус
 на этом списке и, в появившейся в правой части окна панели инструментов,
 выбрать кнопку:
<BR><FONT COLOR="RED"><B>!</B></FONT> Список сохраняется в текстовый файл, содержащий в себе URL, разделенные символом перевода строки
<TD><IMG SRC="../img/export_48.jpg">
</TABLE>

<P><B>Дополнение списка перенаправления запросов</B>
<BR>Дополнение списков запрета доступа может производиться несколькими
способами:

Для дополнения списка запрета доступа необходимо установить фокус на этом
списке и, в появившейся в правой части окна форме, ввести URL и нажать
кнопку <Добавить> (рис. ).

<TABLE WIDTH="90%"><TR>
<TD>Произведите выборку статистики пользователей (или группы пользователей) по
посещенным ресурсам, и в открывшемся списке URL нажмите кнопку
<TD><IMG SRC="../img/stop.jpg">
</TABLE>

<P><B>Удаление URL из списка перенаправления запросов</B>
<BR>Для удаления URL из списка перенаправления запросов, необходимо установить
фокус на этом списке и, в появившейся в правой части окна форме, отметить
URL и нажать кнопку <Удалить>.

</BODY>
</HTML>


