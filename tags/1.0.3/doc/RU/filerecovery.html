<HTML>
<BODY>

<H2 align="center">Восстановление файлов, скачанных пользователями, из кэша SQUID</H2>

<FONT COLOR="RED">Данная функция является экспериментальной, и до конца неотлажена</FONT>

<P>В SAMS добавлена возможность восстанавливать файлы, загруженные пользователями и лежащие в кэше SQUID. 
Для восстановления файлов в веб интерфейсе пероходим: 
<BR><B>SAMS->SQUID и нажимаем на кнопку "Достать файлы,сохраненные в кэше SQUID".</B>
<P><IMG SRC="../img/recovery.jpg">

<P>В появившемся диалоге вводим в поле "Показать все файлы, размером не менее" вводим минимальный размер 
файлов, которые нас интересуют и нажимаем кнопку "Сканировать". Если вы управляете несколькими прокси-серверами, 
необходимо выбрать тот, чей кэш вы будете сканировать.

<P><B>ВНИМАНИЕ!!!</B>Сканирование может занять некоторое время, зависящее от размера вашего кэша, по-этому автоматической 
загрузки списка найденных файлов непредусмотрено.

<P>Далее снова идем 
<BR><B>SAMS->SQUID и нажимаем на кнопку "Достать файлы,сохраненные в кэше SQUID".</B>
<BR>На экран в виде таблицы будет выведен список найденных файлов, удовлетворяющих условию.

<P>Если вас заинтерсовал какой-нибудь файл, щелкаем на него в таблице и нажимаем "Ок" в открывшемся диалоге. 
Этот файл будет скопирован из кэша SQUID в каталог /usr/local/share/sams/data. 
Вы может скопировать его подключившись к покси серверу через ssh или из веб интерфейса SAMS.

<P><B>ВНИМАНИЕ!!!</B>Копирование файла может занять некоторое время (зависит от размера файла и загрузки вашего сервера), 
 по-этому автоматической загрузки файлов непредусмотрено.
<P>Далее снова идем SAMS->SQUID и нажимаем на кнопку "Достать файлы, сохраненные в кэше SQUID". 
Внизу страницы мы увидем список файлов, находящихся в директории /usr/local/share/sams/data. 
Нажмите на нужный файл и скачайте его себе на компьютер

<P><B>Настройка</B>
<P>Для работы этой функции в файл sams.conf введен новый ключ
<BR>SQUIDCACHEDIR=/path/to/squid/cache, обычно это /var/spool/squid 
<BR>Необходимо добавить его в /etc/sams

<P>P.S. Так как формат хранения файлов в кэше SQUID до конца непонятен, восстанавливается примерно 95% файлов.


</BODY>
</HTML>
